<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Save Upload</title>
</head>
<body>
  <h1>セーブファイル送信テスト</h1>
  <form id="uploadForm">
    <label>セーブファイル: <input type="file" id="file" name="file" /></label><br/>
    <label>inquiryCode: <input type="text" id="inquiryCode" name="inquiryCode" /></label><br/>
    <label>password: <input type="password" id="password" name="password" /></label><br/>
    <label>playTime: <input type="number" id="playTime" name="playTime" value="0" /></label><br/>
    <label>rank: <input type="number" id="rank" name="rank" value="0" /></label><br/>
    <button type="submit">送信</button>
  </form>

  <pre id="result"></pre>

  <script>
    const form = document.getElementById("uploadForm");
    const result = document.getElementById("result");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const f = document.getElementById("file").files[0];
      if (!f) { result.textContent = "ファイルを選択してください"; return; }
      const fd = new FormData();
      fd.append("file", f);
      fd.append("inquiryCode", document.getElementById("inquiryCode").value);
      fd.append("password", document.getElementById("password").value);
      fd.append("playTime", document.getElementById("playTime").value);
      fd.append("rank", document.getElementById("rank").value);

      result.textContent = "送信中...";
      try {
        const resp = await fetch("/api/upload", { method: "POST", body: fd });
        const json = await resp.json();
        result.textContent = JSON.stringify(json, null, 2);
      } catch (err) {
        result.textContent = "エラー: " + err;
      }
    });
  </script>
</body>
</html>
