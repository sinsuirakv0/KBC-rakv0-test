<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KBC-official-info</title>
<script src="js/ogp-loader.js"></script>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
</head>
<body class="fade-in">

  <div class="container">
    <header class="header">
      <div class="header-left">
        <img src="logo.png" alt="ロゴ" id="logo" style="cursor: pointer;"> 
        <h1 class="site-title">KBC</h1>
      </div>
      <nav class="nav">
        <a href="index.html">Home</a>
        <a href="https://kbc-rakv0-announce.vercel.app/"></a>
        <a href="#"></a>
      </nav>
</header>
<main class="content-area">
    <h3>公式情報</h3>
    <div class="lang-selector">
        <p>お知らせ言語切り替え:</p>
        <div class="lang-buttons">
            <button onclick="updateLang('ja')">日本語</button>
            <button onclick="updateLang('en')">English</button>
            <button onclick="updateLang('ko')">한국어</button>
            <button onclick="updateLang('tw')">繁體中文</button>
        </div>
    </div>

    <div class="iframe-wrapper">
        <iframe 
            id="announcementIframe"
            src="https://nyanko-announcement.ponosgames.com/v1/notices?clientVersion=999999&countryCode=ja&clearedStageJapan=300&clearedStageFuture=300&clearedUniverse=99999&timeDifference=840&page=" 
            frameborder="0"
            allowfullscreen>
        </iframe>
    </div>

    <hr>

    <details class="gacha-details">
        <summary>ガチャページを表示する</summary>
        <div class="gacha-container-inner">
            <div class="external-search-controls">
                <div class="input-group">
                    <span class="prefix">R</span>
                    <input type="number" id="gachaNumber" value="1034" min="1" max="2000">
                    <button onclick="updateGachaIframe()">表示を更新</button>
                </div>
            </div>
            <section class="gacha-section">
                <div class="iframe-wrapper gacha-view">
                    <iframe id="gachaIframe" src="https://ponosgames.com/information/appli/battlecats/gacha/rare/R1034.html" frameborder="0"></iframe>
                </div>
            </section>
        </div>
    </details>

  <hr>

    <details class="gacha-details">
        <summary>ステージ情報を表示する</summary>
        <div class="gacha-container-inner">
            <div class="external-search-controls">
                <div class="input-group">
                  <h3>技術的制限により、章の名前とステージ数しか見れません。</h3>
                    <select id="stageType">
                        <option value="S">S イベントステージ</option>
                        <option value="A">A 強襲</option>
                        <option value="C">C コラボ</option>
                        <option value="CA">CA コラボ強襲</option>
                        <option value="N">N 旧レジェ</option>
                        <option value="NA">NA 真レジェ</option>
                        <option value="ND" selected>ND 0レジェ</option>
                        <option value="H">H 地図</option>
                        <option value="V">V 塔</option>
                        <option value="R">R 道場</option>
                        <option value="Q">Q 超獣</option>
                        <option value="SR">SR スペシャルルール</option>
                    </select>
                    <input type="number" id="stageNumber" value="0" min="0" max="999" style="width: 80px;">
                    <button onclick="updateStageIframe()">ステージページ表示</button>
                </div>
            </div>
            <section class="gacha-section">
                <div class="iframe-wrapper gacha-view">
                    <iframe id="stageIframe" src="https://ponosgames.com/information/appli/battlecats/stage/ND000.html" frameborder="0"></iframe>
                </div>
            </section>
        </div>
    </details>

<hr>

<details class="gacha-details">
    <summary>敵アイコン検索</summary>
    
    <div class="gacha-container-inner">
        <div class="external-search-controls">
            <div class="input-group">
              <a href="https://jarjarblink.github.io/JDB/tunit_search.html?cc=ja">敵ID検索　　</a>
                <span class="prefix">No.</span>
                <input type="number" id="enemyNumber" value="0" min="0" max="999" style="width: 80px;">
                <button onclick="updateEnemyImage()">画像を表示</button>
            </div>
        </div>

        <section class="gacha-section" style="text-align: center; background: transparent;">
            <div class="enemy-icon-wrapper" style="margin-top: 20px;">
                <img id="enemyIcon" 
                     src="https://ponosgames.com/information/appli/battlecats/stage/img/enemy/enemy_icon_000.png" 
                     alt="敵アイコン" 
                     style="width: 128px; height: auto; border: 2px solid var(--accent); border-radius: 10px; padding: 5px; background: rgba(255,255,255,0.1);">
            </div>
        </section>
    </div>
</details>

  <hr>

<details class="gacha-details">
    <summary>にゃんこ大戦争 HELPを表示</summary>
    
    <div class="gacha-container-inner">
        <section class="gacha-section" style="background: transparent; padding: 0;">
            <div class="iframe-wrapper" style="height: 60vh; border: 1px solid var(--border);">
                <iframe 
                    id="helpIframe" 
                    src="https://ponosgames.com/information/appli/battlecats/help/index.html" 
                    frameborder="0">
                </iframe>
            </div>
        </section>
    </div>
</details>
</main>
</div> 
  <script>

function updateStageIframe() {
    // 選択されたカテゴリ（S, NA, NDなど）を取得
    const type = document.getElementById('stageType').value;
    // 入力された数値を取得
    const num = document.getElementById('stageNumber').value;
    
    // 数字を必ず3桁の文字列に変換（例: 1 -> 001, 99 -> 099）
    const numStr = num.toString().padStart(3, '0');
    
    // URLを組み立て
    const newUrl = `https://ponosgames.com/information/appli/battlecats/stage/${type}${numStr}.html`;
    
    console.log("ステージURL生成:", newUrl);
    
    // iframeを更新
    document.getElementById('stageIframe').src = newUrl;
}
    
function updateEnemyImage() {
    const num = document.getElementById('enemyNumber').value;
    
    // 数字を3桁に揃える (例: 5 -> 005)
    const numStr = num.toString().padStart(3, '0');
    
    // 画像のURLを作成
    const newImageUrl = `https://ponosgames.com/information/appli/battlecats/stage/img/enemy/enemy_icon_${numStr}.png`;
    
    // 画像タグのsrcを更新
    document.getElementById('enemyIcon').src = newImageUrl;
    
    // 確認用にURLテキストも更新
    document.getElementById('enemyUrlText').innerText = `URL: ${newImageUrl}`;
    
    console.log("敵アイコンURL更新:", newImageUrl);
} 
  function updateLang(langCode) {
    const iframe = document.getElementById('announcementIframe');
    // 現在のURLを取得
    let currentUrl = iframe.src;
    
    // URLの中の countryCode= の後の2〜5文字(ja, en, zh-twなど)を置換
    // 正規表現を使って countryCode=... の部分を書き換えます
    const newUrl = currentUrl.replace(/countryCode=[a-z-]{2,5}/, `countryCode=${langCode}`);
    
    iframe.src = newUrl;
}
    
function updateGachaIframe() {
    const inputVal = document.getElementById('gachaNumber').value;
    let numStr;

    if (inputVal < 1000) {
        // 1000未満の場合は、3桁になるようにゼロで埋める（例: 99 -> 099, 5 -> 005）
        numStr = inputVal.toString().padStart(3, '0');
    } else {
        // 1000以上の場合は、そのままの数字を使う
        numStr = inputVal.toString();
    }

    const newUrl = `https://ponosgames.com/information/appli/battlecats/gacha/rare/R${numStr}.html`;
    
    console.log("生成されたURL:", newUrl);
    document.getElementById('gachaIframe').src = newUrl;
}
</script>

<script src="js/secret.js"></script>
</body>
</html>

<script src="js/secret.js"></script>

</html>
